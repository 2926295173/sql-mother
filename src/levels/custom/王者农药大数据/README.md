# 王者农药大数据

## 背景故事
你是"企鹅游戏公司"的数据分析师，《王者农药》手游风靡全球，每天产生海量的游戏数据。运营总监想要了解玩家的游戏习惯和付费行为，希望你能从数据中找出提升游戏体验和收入的秘诀！

## 数据说明
我们有一个游戏记录表 `game_matches`，记录了召唤师们的对局信息：

- `match_id`：对局ID
- `player_id`：玩家ID
- `player_name`：玩家昵称
- `hero_name`：使用英雄
- `hero_role`：英雄定位（战士、法师、射手、辅助、坦克、刺客）
- `game_result`：游戏结果（胜利/失败）
- `kills`：击杀数
- `deaths`：死亡数
- `assists`：助攻数
- `game_duration`：游戏时长（分钟）
- `match_date`：对局日期

## 任务要求
运营团队想要了解英雄的表现情况，请你编写SQL查询：

1. 统计每个英雄定位的胜率（胜利场次/总场次*100）
2. 计算每个英雄定位的平均KDA（(击杀+助攻)/死亡）
3. 统计每个英雄定位的总对局数
4. 只显示对局数大于等于5场的英雄定位
5. 按胜率降序排列
6. 返回字段：英雄定位（hero_role）、胜率（win_rate，保留1位小数，加%符号）、平均KDA（avg_kda，保留2位小数）、总对局数（total_matches）

## 提示
- 使用CASE WHEN统计胜利场次
- 使用HAVING过滤聚合结果
- 使用字符串拼接函数 || 添加%符号
- 注意处理除零情况

让我们看看哪个定位的英雄最强势吧！⚔️ 