# 医院挂号分析

## 背景故事
你是"仁心医院"的数据分析师，医院院长最近发现挂号系统积累了大量数据，想要了解患者就诊规律。他希望你能分析出哪些科室最忙、哪个时间段患者最多，为医院排班和资源配置提供科学依据！

## 数据说明
我们有一个挂号记录表 `hospital_appointments`，记录了患者的挂号信息：

- `appointment_id`：挂号ID
- `patient_id`：患者ID
- `patient_name`：患者姓名
- `patient_age`：患者年龄
- `patient_gender`：患者性别（M/F）
- `department`：科室（内科、外科、儿科、妇产科、骨科、眼科）
- `doctor_name`：医生姓名
- `appointment_date`：挂号日期
- `appointment_time`：挂号时间段（上午/下午）
- `registration_fee`：挂号费（元）
- `is_emergency`：是否急诊（1/0）
- `visit_type`：就诊类型（初诊/复诊）

## 任务要求
院长想要了解各科室的就诊情况，请你编写SQL查询：

1. 计算每个科室的总挂号费收入
2. 统计每个科室的挂号人次
3. 计算每个科室的平均患者年龄
4. 统计每个科室的急诊比例
5. 找出每个科室就诊人次最多的时间段（上午/下午）
6. 计算每个科室的男女患者比例
7. 按总挂号费收入降序排列

返回字段：
- 科室名称（department）
- 总挂号费（total_fee）
- 挂号人次（total_visits）
- 平均年龄（avg_age，保留1位小数）
- 急诊比例（emergency_ratio，保留1位小数，加%符号）
- 热门时段（popular_time）
- 男女比例（gender_ratio，格式如"60.0%:40.0%"）

## 示例结果
```
科室：内科，总挂号费：1200元，挂号人次：40次，平均年龄：45.5岁，急诊比例：15.0%，热门时段：上午，男女比例：55.0%:45.0%
```

快来看看哪个科室最受患者青睐吧！🏥 