# 朋友圈的秘密

## 背景故事
你是朋友圈的数据分析师，春节期间用户活跃度暴增，产品经理想要了解用户的社交行为模式。她希望你能从海量的社交数据中挖掘出用户互动的规律，为产品优化提供数据支撑！

## 数据说明
我们有一个围脖数据表 `weibo_posts`，记录了用户发布的内容信息：

- `post_id`：微博ID
- `user_id`：用户ID
- `username`：用户名
- `content_type`：内容类型（原创、转发、评论）
- `topic_category`：话题分类（科技、娱乐、体育、时事、生活、教育）
- `publish_time`：发布时间
- `likes_count`：点赞数
- `comments_count`：评论数
- `reposts_count`：转发数
- `followers_count`：发布者粉丝数
- `has_image`：是否包含图片（1/0）
- `has_video`：是否包含视频（1/0）

## 任务要求
产品经理想要了解内容传播效果，请你编写SQL查询：

1. 计算每个话题分类的总互动数（点赞+评论+转发）
2. 计算每个话题分类的平均互动率（总互动数/总粉丝数*1000）
3. 统计每个话题分类中包含图片的内容占比
4. 统计每个话题分类中包含视频的内容占比  
5. 计算每个话题分类的平均点赞数
6. 只显示内容数量大于等于3条的话题分类
7. 按总互动数降序排列

返回字段：
- 话题分类（topic_category）
- 总互动数（total_interactions）
- 平均互动率（avg_interaction_rate，保留3位小数）
- 图片占比（image_ratio，保留1位小数，加%符号）
- 视频占比（video_ratio，保留1位小数，加%符号）
- 平均点赞数（avg_likes，保留整数）
- 内容数量（post_count）

## 提示
- 使用SUM和AVG函数进行聚合计算
- 使用CASE WHEN计算占比
- 使用HAVING过滤分组结果
- 注意数据类型转换

让我们看看哪类话题最受用户欢迎吧！📱 