# 金牛投资

## 背景故事
你是"金牛投资"的风控分析师，最近市场波动剧烈，公司积累了大量的金融交易数据。风控总监想要分析各类金融产品的风险收益情况，希望你能从数据中找出最优的投资组合策略！

## 数据说明
我们有一个股票交易表 `stock_transactions`，记录了每笔交易的详细信息：

- `transaction_id`：交易ID
- `stock_code`：股票代码
- `stock_name`：股票名称
- `sector`：行业板块（科技、金融、医药、消费、能源、制造）
- `transaction_date`：交易日期
- `transaction_type`：交易类型（买入/卖出）
- `quantity`：交易数量（股）
- `price_per_share`：每股价格（元）
- `commission_fee`：手续费（元）
- `investor_id`：投资者ID
- `investor_type`：投资者类型（个人/机构）
- `market_cap`：市值等级（大盘股/中盘股/小盘股）

## 任务要求
投资总监想要了解各行业板块的交易情况，请你编写SQL查询：

1. 计算每个行业板块的总交易金额（数量 × 每股价格）
2. 统计每个行业板块的交易笔数
3. 计算每个行业板块的平均每股价格
4. 计算每个行业板块的买入卖出比例
5. 统计每个行业板块中机构投资者的交易占比
6. 计算每个行业板块的平均手续费
7. 找出每个行业板块交易金额最大的股票
8. 计算每个行业板块的价格波动率（最高价与最低价的差值占平均价格的比例）
9. 按总交易金额降序排列

返回字段：
- 行业板块（sector）
- 总交易金额（total_amount，保留2位小数）
- 交易笔数（transaction_count）
- 平均股价（avg_price，保留2位小数）
- 买入占比（buy_ratio，保留1位小数，加%符号）
- 机构占比（institution_ratio，保留1位小数，加%符号）
- 平均手续费（avg_commission，保留2位小数）
- 热门股票（top_stock）
- 价格波动率（volatility，保留1位小数，加%符号）

## 示例结果
```
板块：科技，总金额：50000000.00元，交易笔数：120笔，平均股价：85.50元，买入占比：55.0%，机构占比：65.0%，平均手续费：25.80元，热门股票：企鹅控股，波动率：15.2%
```

快来看看哪个行业板块最受投资者青睐吧！📈 