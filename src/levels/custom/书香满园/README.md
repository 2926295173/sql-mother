# 书香满园

## 背景故事
你是"知识海洋书店"的数据分析师，春节假期过后，店长想要总结上个月的销售情况。她发现有些书卖得特别好，有些书却无人问津，希望你能从销售数据中找出规律，为下个月的进货计划提供数据支撑！

## 数据说明
我们有一个图书销售表 `book_sales`，记录了每笔销售的详细信息：

- `sale_id`：销售ID
- `book_id`：图书ID
- `book_title`：书名
- `author`：作者
- `category`：图书分类（文学、科技、教育、生活、历史、经济）
- `publisher`：出版社
- `price`：单价（元）
- `quantity`：销售数量
- `sale_date`：销售日期
- `customer_age`：顾客年龄
- `customer_gender`：顾客性别（M/F）
- `discount_rate`：折扣率（0.8表示8折）

## 任务要求
店长想要了解不同图书分类的销售表现，请你编写SQL查询：

1. 计算每个图书分类的总销售额（单价 × 数量 × 折扣率）
2. 统计每个图书分类的销售册数
3. 计算每个图书分类的平均折扣率
4. 找出每个图书分类中销售额最高的图书
5. 计算每个图书分类的平均顾客年龄
6. 按总销售额降序排列

返回字段：
- 图书分类（category）
- 总销售额（total_revenue，保留2位小数）
- 销售册数（total_books）
- 平均折扣率（avg_discount，保留3位小数）
- 最畅销图书（top_book）
- 平均顾客年龄（avg_age，保留1位小数）

## 示例结果
```
分类：文学，总销售额：25680.50元，销售册数：180册，平均折扣：0.850，最畅销：《百年孤独》，平均年龄：32.5岁
```

快来看看哪类图书最受读者欢迎吧！📚 