# 数据淘金客

## 背景故事
你是"淘宝天下"电商平台的用户运营分析师，平台积累了海量的用户行为数据。市场总监想要深入了解不同年龄段用户的消费特征，制定精准的营销策略。这个重要任务落到了你的肩上，快来挖掘用户数据中的黄金信息吧！

## 数据说明
我们有一个用户行为表 `ecommerce_behavior`，记录了用户的基本信息和消费行为：

- `user_id`：用户ID
- `user_name`：用户姓名
- `age`：用户年龄
- `gender`：用户性别（男/女）
- `city`：所在城市
- `registration_date`：注册日期
- `total_orders`：总订单数
- `total_amount`：总消费金额（元）
- `avg_order_amount`：平均订单金额（元）
- `favorite_category`：偏好品类
- `last_order_date`：最后下单日期
- `is_vip`：是否VIP用户（1是/0否）

## 任务要求
运营团队需要一个年龄段用户分析报告，请你编写SQL查询：

1. 将用户按年龄分组：年轻群体（<30岁）、中年群体（30-49岁）、高龄群体（≥50岁）
2. 统计每个年龄段的用户数量
3. 计算每个年龄段的平均消费金额
4. 计算每个年龄段的平均订单数
5. 计算每个年龄段的平均订单价值
6. 计算每个年龄段的VIP用户占比
7. 计算每个年龄段的性别比例（男性%:女性%）
8. 找出每个年龄段最受欢迎的商品品类（按总消费金额）
9. 按平均消费金额降序排列

返回字段：
- 年龄段（age_group）
- 用户数量（user_count）
- 平均消费金额（avg_amount，保留2位小数）
- 平均订单数（avg_orders，保留1位小数）
- 平均订单价值（avg_order_value，保留2位小数）
- VIP占比（vip_ratio，保留1位小数，加%符号）
- 性别比例（gender_ratio，格式：男性%:女性%）
- 热门品类（popular_category）

## 提示
- 使用CASE WHEN进行年龄分组
- 使用子查询找出热门品类
- 注意性别比例的格式要求

这是一个复杂的用户画像分析，考验你的数据分析能力！📊 